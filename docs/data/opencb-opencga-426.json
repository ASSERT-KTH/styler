{
    "project_name": "opencb-opencga",
    "error_id": "426",
    "information": {
        "errors": [
            {
                "line": "126",
                "severity": "error",
                "message": "Line is longer than 140 characters (found 145).",
                "source": "com.puppycrawl.tools.checkstyle.checks.sizes.LineLengthCheck"
            }
        ]
    },
    "source_code": "        // Check BAM file\n        if (catalogBamFile == null) {\n            addWarning(\"Skipping picard/CollectHsMetrics analysis: no BAM file was provided and no BAM file found for sample \" + sample.getId());\n            return;\n        }\n",
    "results": [
        {
            "tool": "styler",
            "errors": [
                {
                    "line": "126",
                    "severity": "error",
                    "message": "Line is longer than 140 characters (found 145).",
                    "source": "com.puppycrawl.tools.checkstyle.checks.sizes.LineLengthCheck"
                }
            ],
            "diff": "",
            "diff_size": 0
        },
        {
            "tool": "intellij",
            "errors": [],
            "diff": "diff --git a/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/errored/1/426/SampleQcLocalAnalysisExecutor.java b/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/intellij/426/SampleQcLocalAnalysisExecutor.java\nindex 1d1cfd99ce7..5ccd144efbc 100644\n--- a/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/errored/1/426/SampleQcLocalAnalysisExecutor.java\n+++ b/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/intellij/426/SampleQcLocalAnalysisExecutor.java\n@@ -41,45 +41,45 @@ import java.util.List;\n \n import static org.opencb.opencga.core.api.ParamConstants.LOW_COVERAGE_REGION_THRESHOLD_DEFAULT;\n \n-@ToolExecutor(id=\"opencga-local\", tool = SampleQcAnalysis.ID, framework = ToolExecutor.Framework.LOCAL,\n-        source = ToolExecutor.Source.STORAGE)\n+@ToolExecutor(id = \"opencga-local\", tool = SampleQcAnalysis.ID, framework = ToolExecutor.Framework.LOCAL,\n+    source = ToolExecutor.Source.STORAGE)\n public class SampleQcLocalAnalysisExecutor extends SampleQcAnalysisExecutor implements StorageToolExecutor {\n \n-    private CatalogManager catalogManager;\n+  private CatalogManager catalogManager;\n \n-    @Override\n-    public void run() throws ToolException {\n-        // Sanity check: metrics to update can not be null\n-        if (alignmentQcMetrics == null) {\n-            throw new ToolException(\"Sample alignment quality control metrics is null\");\n-        }\n+  @Override\n+  public void run() throws ToolException {\n+    // Sanity check: metrics to update can not be null\n+    if (alignmentQcMetrics == null) {\n+      throw new ToolException(\"Sample alignment quality control metrics is null\");\n+    }\n \n-        catalogManager = getVariantStorageManager().getCatalogManager();\n+    catalogManager = getVariantStorageManager().getCatalogManager();\n \n-        switch (qcType) {\n+    switch (qcType) {\n \n-            case FLAG_STATS: {\n-                runFlagStats();\n-                break;\n-            }\n+      case FLAG_STATS: {\n+        runFlagStats();\n+        break;\n+      }\n \n-            case HS_METRICS: {\n-                runHsMetrics();\n-                break;\n-            }\n+      case HS_METRICS: {\n+        runHsMetrics();\n+        break;\n+      }\n \n-            case GENE_COVERAGE_STATS: {\n-                runGeneCoverageStats();\n-                break;\n-            }\n+      case GENE_COVERAGE_STATS: {\n+        runGeneCoverageStats();\n+        break;\n+      }\n \n-            default: {\n-                throw new ToolException(\"Unknown quality control type: \" + qcType);\n-            }\n-        }\n+      default: {\n+        throw new ToolException(\"Unknown quality control type: \" + qcType);\n+      }\n     }\n+  }\n \n-    private void runFlagStats() throws ToolException {\n+  private void runFlagStats() throws ToolException {\n //        if (alignmentQcMetrics.getSamtoolsFlagstats() != null) {\n //            // Samtools flag stats already exists!\n //            addWarning(\"Skipping samtools/flagstat analysis: it was already computed\");\n@@ -110,158 +110,158 @@ public class SampleQcLocalAnalysisExecutor extends SampleQcAnalysisExecutor impl\n //        if (flagtats != null) {\n //            alignmentQcMetrics.setSamtoolsFlagstats(flagtats);\n //        }\n+  }\n+\n+  private void runHsMetrics() throws ToolException {\n+    addWarning(\"Skipping picard/CollectHsMetrics analysis: not yet implemented\");\n+\n+    if (alignmentQcMetrics.getHsMetrics() != null) {\n+      // Hs metrics already exists!\n+      addWarning(\"Skipping picard/CollectHsMetrics analysis: it was already computed\");\n+      return;\n     }\n \n-    private void runHsMetrics() throws ToolException {\n-        addWarning(\"Skipping picard/CollectHsMetrics analysis: not yet implemented\");\n+    // Check BAM file\n+    if (catalogBamFile == null) {\n+      addWarning(\"Skipping picard/CollectHsMetrics analysis: no BAM file was provided and no BAM file found for sample \" + sample.getId());\n+      return;\n+    }\n \n-        if (alignmentQcMetrics.getHsMetrics() != null) {\n-            // Hs metrics already exists!\n-            addWarning(\"Skipping picard/CollectHsMetrics analysis: it was already computed\");\n-            return;\n-        }\n+    // Check bait file\n+    if (StringUtils.isEmpty(getBaitFile())) {\n+      addWarning(\"Skipping picard/CollectHsMetrics analysis: no bait file was provided\");\n+      return;\n+    }\n+    File bedBaitFile;\n+    try {\n+      bedBaitFile = AnalysisUtils.getCatalogFile(getBaitFile(), getStudyId(), catalogManager.getFileManager(), getToken());\n+    } catch (CatalogException e) {\n+      throw new ToolException(e);\n+    }\n \n-        // Check BAM file\n-        if (catalogBamFile == null) {\n-            addWarning(\"Skipping picard/CollectHsMetrics analysis: no BAM file was provided and no BAM file found for sample \" + sample.getId());\n-            return;\n-        }\n+    // Check dictionary file\n+    if (StringUtils.isEmpty(getDictFile())) {\n+      addWarning(\"Skipping picard/CollectHsMetrics analysis: no dictionary file was provided\");\n+      return;\n+    }\n+    File dictFile;\n+    try {\n+      dictFile = AnalysisUtils.getCatalogFile(getDictFile(), getStudyId(), catalogManager.getFileManager(), getToken());\n+    } catch (CatalogException e) {\n+      throw new ToolException(e);\n+    }\n \n-        // Check bait file\n-        if (StringUtils.isEmpty(getBaitFile())) {\n-            addWarning(\"Skipping picard/CollectHsMetrics analysis: no bait file was provided\");\n-            return;\n-        }\n-        File bedBaitFile;\n-        try {\n-            bedBaitFile = AnalysisUtils.getCatalogFile(getBaitFile(), getStudyId(), catalogManager.getFileManager(), getToken());\n-        } catch (CatalogException e) {\n-            throw new ToolException(e);\n-        }\n+    // Run picard/BedToIntervalList, to convert BED file to INTERVAL\n+    String intervalFilename = bedBaitFile.getName() + \".interval\";\n+    ObjectMap params = new ObjectMap()\n+        .append(\"I\", bedBaitFile.getId())\n+        .append(\"SD\", dictFile.getId())\n+        .append(\"O\", intervalFilename);\n \n-        // Check dictionary file\n-        if (StringUtils.isEmpty(getDictFile())) {\n-            addWarning(\"Skipping picard/CollectHsMetrics analysis: no dictionary file was provided\");\n-            return;\n-        }\n-        File dictFile;\n-        try {\n-            dictFile = AnalysisUtils.getCatalogFile(getDictFile(), getStudyId(), catalogManager.getFileManager(), getToken());\n-        } catch (CatalogException e) {\n-            throw new ToolException(e);\n-        }\n \n-        // Run picard/BedToIntervalList, to convert BED file to INTERVAL\n-        String intervalFilename = bedBaitFile.getName() + \".interval\";\n-        ObjectMap params = new ObjectMap()\n-                .append(\"I\", bedBaitFile.getId())\n-                .append(\"SD\", dictFile.getId())\n-                .append(\"O\", intervalFilename);\n+    Path picardDir = getOutDir().resolve(\"picard\");\n+    Path picardScratchDir = picardDir.resolve(\"scratch\");\n+    picardScratchDir.toFile().mkdirs();\n \n+    PicardWrapperAnalysisExecutor picardExecutor = new PicardWrapperAnalysisExecutor(getStudyId(), params, picardDir, picardScratchDir,\n+        catalogManager, getToken());\n \n-        Path picardDir = getOutDir().resolve(\"picard\");\n-        Path picardScratchDir = picardDir.resolve(\"scratch\");\n-        picardScratchDir.toFile().mkdirs();\n+    picardExecutor.setCommand(\"BedToIntervalList\");\n+    picardExecutor.run();\n \n-        PicardWrapperAnalysisExecutor picardExecutor = new PicardWrapperAnalysisExecutor(getStudyId(), params, picardDir, picardScratchDir,\n-                catalogManager, getToken());\n+    if (!picardDir.resolve(intervalFilename).toFile().exists()) {\n+      throw new ToolException(\"Error converting BED file '\" + getBaitFile() + \"' to interval format using Picard\"\n+          + \" command: \" + picardExecutor.getCommand());\n+    }\n \n-        picardExecutor.setCommand(\"BedToIntervalList\");\n-        picardExecutor.run();\n+    // Link interval file to catalog, we need to do it to execute CollectHsMetrics\n+    File intervalFile;\n+    try {\n+      intervalFile = catalogManager.getFileManager().link(getStudyId(), picardDir.resolve(intervalFilename).toUri(),\n+          \"BedToIntervalList.\" + RandomStringUtils.randomAlphabetic(6), new ObjectMap(\"parents\", true), getToken()).first();\n \n-        if (!picardDir.resolve(intervalFilename).toFile().exists()) {\n-            throw new ToolException(\"Error converting BED file '\" + getBaitFile() + \"' to interval format using Picard\"\n-                    + \" command: \" + picardExecutor.getCommand());\n-        }\n+    } catch (CatalogException e) {\n+      throw new ToolException(e);\n+    }\n \n-        // Link interval file to catalog, we need to do it to execute CollectHsMetrics\n-        File intervalFile;\n-        try {\n-            intervalFile = catalogManager.getFileManager().link(getStudyId(), picardDir.resolve(intervalFilename).toUri(),\n-                    \"BedToIntervalList.\" + RandomStringUtils.randomAlphabetic(6), new ObjectMap(\"parents\", true), getToken()).first();\n+    // Run picard/CollectHsMetrics\n+    String hsMetricsFilename = \"hsmetrics.txt\";\n+    params = new ObjectMap()\n+        .append(\"I\", catalogBamFile.getId())\n+        .append(\"BI\", intervalFile.getId())\n+        .append(\"TI\", intervalFile.getId())\n+        .append(\"O\", hsMetricsFilename);\n+    picardExecutor = new PicardWrapperAnalysisExecutor(getStudyId(), params, picardDir, picardScratchDir, catalogManager, getToken());\n \n-        } catch (CatalogException e) {\n-            throw new ToolException(e);\n-        }\n+    picardExecutor.setCommand(\"CollectHsMetrics\");\n+    picardExecutor.run();\n \n-        // Run picard/CollectHsMetrics\n-        String hsMetricsFilename = \"hsmetrics.txt\";\n-        params = new ObjectMap()\n-                .append(\"I\", catalogBamFile.getId())\n-                .append(\"BI\", intervalFile.getId())\n-                .append(\"TI\", intervalFile.getId())\n-                .append(\"O\", hsMetricsFilename);\n-        picardExecutor = new PicardWrapperAnalysisExecutor(getStudyId(), params, picardDir, picardScratchDir, catalogManager, getToken());\n+    if (!picardDir.resolve(hsMetricsFilename).toFile().exists()) {\n+      throw new ToolException(\"Error running Picard command: \" + picardExecutor.getCommand());\n+    }\n \n-        picardExecutor.setCommand(\"CollectHsMetrics\");\n-        picardExecutor.run();\n+    try {\n+      // Parse Hs metrics and update sample quality control\n+      HsMetrics hsMetrics = HsMetricsParser.parse(picardDir.resolve(hsMetricsFilename).toFile());\n+      alignmentQcMetrics.setHsMetrics(hsMetrics);\n+    } catch (IOException e) {\n+      throw new ToolException(e);\n+    }\n+  }\n \n-        if (!picardDir.resolve(hsMetricsFilename).toFile().exists()) {\n-            throw new ToolException(\"Error running Picard command: \" + picardExecutor.getCommand());\n-        }\n+  private void runGeneCoverageStats() throws ToolException {\n+    // Check BAM file\n+    if (catalogBamFile == null) {\n+      addWarning(\"Skipping gene coverage stats analysis: no BAM file was provided\");\n+      return;\n+    }\n \n-        try {\n-            // Parse Hs metrics and update sample quality control\n-            HsMetrics hsMetrics = HsMetricsParser.parse(picardDir.resolve(hsMetricsFilename).toFile());\n-            alignmentQcMetrics.setHsMetrics(hsMetrics);\n-        } catch (IOException e) {\n-            throw new ToolException(e);\n-        }\n+    // Check genes\n+    if (CollectionUtils.isEmpty(getGenesForCoverageStats())) {\n+      addWarning(\"Skipping gene coverage stats analysis: missing genes\");\n+      return;\n     }\n \n-    private void runGeneCoverageStats() throws ToolException {\n-        // Check BAM file\n-        if (catalogBamFile == null) {\n-            addWarning(\"Skipping gene coverage stats analysis: no BAM file was provided\");\n-            return;\n-        }\n+    // Sanity check\n+    List<GeneCoverageStats> geneCoverageStats = alignmentQcMetrics.getGeneCoverageStats();\n+    if (geneCoverageStats == null) {\n+      geneCoverageStats = new ArrayList<>();\n+    }\n \n-        // Check genes\n-        if (CollectionUtils.isEmpty(getGenesForCoverageStats())) {\n-            addWarning(\"Skipping gene coverage stats analysis: missing genes\");\n-            return;\n+    List<String> targetGenes = new ArrayList<>();\n+    if (CollectionUtils.isEmpty(geneCoverageStats)) {\n+      targetGenes = getGenesForCoverageStats();\n+    } else {\n+      for (String gene : getGenesForCoverageStats()) {\n+        boolean found = false;\n+        for (GeneCoverageStats stats : geneCoverageStats) {\n+          if (gene.equals(stats.getGeneName())) {\n+            found = true;\n+            addWarning(\"Skipping gene coverage stats for gene \" + gene + \": it was already computed\");\n+            break;\n+          }\n         }\n-\n-        // Sanity check\n-        List<GeneCoverageStats> geneCoverageStats = alignmentQcMetrics.getGeneCoverageStats();\n-        if (geneCoverageStats == null) {\n-            geneCoverageStats = new ArrayList<>();\n+        if (!found) {\n+          targetGenes.add(gene);\n         }\n+      }\n+    }\n \n-        List<String> targetGenes = new ArrayList<>();\n-        if (CollectionUtils.isEmpty(geneCoverageStats)) {\n-            targetGenes = getGenesForCoverageStats();\n-        } else {\n-            for (String gene : getGenesForCoverageStats()) {\n-                boolean found = false;\n-                for (GeneCoverageStats stats : geneCoverageStats) {\n-                    if (gene.equals(stats.getGeneName())) {\n-                        found = true;\n-                        addWarning(\"Skipping gene coverage stats for gene \" + gene + \": it was already computed\");\n-                        break;\n-                    }\n-                }\n-                if (!found) {\n-                    targetGenes.add(gene);\n-                }\n-            }\n-        }\n+    if (CollectionUtils.isNotEmpty(targetGenes)) {\n+      try {\n+        OpenCGAResult<GeneCoverageStats> geneCoverageStatsResult = getAlignmentStorageManager().coverageStats(getStudyId(),\n+            catalogBamFile.getId(), targetGenes, Integer.parseInt(LOW_COVERAGE_REGION_THRESHOLD_DEFAULT), getToken());\n \n-        if (CollectionUtils.isNotEmpty(targetGenes)) {\n-            try {\n-                OpenCGAResult<GeneCoverageStats> geneCoverageStatsResult = getAlignmentStorageManager().coverageStats(getStudyId(),\n-                        catalogBamFile.getId(), targetGenes, Integer.parseInt(LOW_COVERAGE_REGION_THRESHOLD_DEFAULT), getToken());\n-\n-                if (geneCoverageStatsResult.getNumResults() != 1) {\n-                    throw new ToolException(\"Something wrong happened when computing gene coverage stats: no results returned\");\n-                }\n-                geneCoverageStats.add(geneCoverageStatsResult.first());\n-\n-                // Add result to the list\n-                alignmentQcMetrics.setGeneCoverageStats(geneCoverageStats);\n-            } catch (Exception e) {\n-                throw new ToolException(e);\n-            }\n+        if (geneCoverageStatsResult.getNumResults() != 1) {\n+          throw new ToolException(\"Something wrong happened when computing gene coverage stats: no results returned\");\n         }\n+        geneCoverageStats.add(geneCoverageStatsResult.first());\n+\n+        // Add result to the list\n+        alignmentQcMetrics.setGeneCoverageStats(geneCoverageStats);\n+      } catch (Exception e) {\n+        throw new ToolException(e);\n+      }\n     }\n+  }\n }\n",
            "diff_size": 217
        },
        {
            "tool": "naturalize",
            "errors": [
                {
                    "line": "123",
                    "severity": "error",
                    "message": "Line is longer than 140 characters (found 145).",
                    "source": "com.puppycrawl.tools.checkstyle.checks.sizes.LineLengthCheck"
                }
            ],
            "diff": "diff --git a/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/errored/1/426/SampleQcLocalAnalysisExecutor.java b/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/naturalize/426/SampleQcLocalAnalysisExecutor.java\nindex 1d1cfd99ce7..01fdd4344f4 100644\n--- a/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/errored/1/426/SampleQcLocalAnalysisExecutor.java\n+++ b/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/naturalize/426/SampleQcLocalAnalysisExecutor.java\n@@ -41,7 +41,7 @@ import java.util.List;\n \n import static org.opencb.opencga.core.api.ParamConstants.LOW_COVERAGE_REGION_THRESHOLD_DEFAULT;\n \n-@ToolExecutor(id=\"opencga-local\", tool = SampleQcAnalysis.ID, framework = ToolExecutor.Framework.LOCAL,\n+@ToolExecutor(id = \"opencga-local\", tool = SampleQcAnalysis.ID, framework = ToolExecutor.Framework.LOCAL,\n         source = ToolExecutor.Source.STORAGE)\n public class SampleQcLocalAnalysisExecutor extends SampleQcAnalysisExecutor implements StorageToolExecutor {\n \n@@ -57,18 +57,15 @@ public class SampleQcLocalAnalysisExecutor extends SampleQcAnalysisExecutor impl\n         catalogManager = getVariantStorageManager().getCatalogManager();\n \n         switch (qcType) {\n-\n-            case FLAG_STATS: {\n+    case FLAG_STATS: {\n                 runFlagStats();\n                 break;\n             }\n-\n-            case HS_METRICS: {\n+case HS_METRICS: {\n                 runHsMetrics();\n                 break;\n             }\n-\n-            case GENE_COVERAGE_STATS: {\n+case GENE_COVERAGE_STATS: {\n                 runGeneCoverageStats();\n                 break;\n             }\n@@ -157,9 +154,7 @@ public class SampleQcLocalAnalysisExecutor extends SampleQcAnalysisExecutor impl\n                 .append(\"I\", bedBaitFile.getId())\n                 .append(\"SD\", dictFile.getId())\n                 .append(\"O\", intervalFilename);\n-\n-\n-        Path picardDir = getOutDir().resolve(\"picard\");\n+Path picardDir = getOutDir().resolve(\"picard\");\n         Path picardScratchDir = picardDir.resolve(\"scratch\");\n         picardScratchDir.toFile().mkdirs();\n \n@@ -264,4 +259,4 @@ public class SampleQcLocalAnalysisExecutor extends SampleQcAnalysisExecutor impl\n             }\n         }\n     }\n-}\n+}\n\\ No newline at end of file\n",
            "diff_size": 11
        },
        {
            "tool": "codebuff",
            "errors": null,
            "diff": null
        },
        {
            "tool": "styler_random",
            "errors": [
                {
                    "line": "126",
                    "severity": "error",
                    "message": "Line is longer than 140 characters (found 145).",
                    "source": "com.puppycrawl.tools.checkstyle.checks.sizes.LineLengthCheck"
                }
            ],
            "diff": "",
            "diff_size": 0
        },
        {
            "tool": "styler_three_grams",
            "errors": [
                {
                    "line": "126",
                    "column": "127",
                    "severity": "error",
                    "message": "'+' is not preceded with whitespace.",
                    "source": "com.puppycrawl.tools.checkstyle.checks.whitespace.WhitespaceAroundCheck"
                },
                {
                    "line": "126",
                    "column": "128",
                    "severity": "error",
                    "message": "'+' is not followed by whitespace.",
                    "source": "com.puppycrawl.tools.checkstyle.checks.whitespace.WhitespaceAroundCheck"
                },
                {
                    "line": "127",
                    "column": "22",
                    "severity": "error",
                    "message": "';' is not followed by whitespace.",
                    "source": "com.puppycrawl.tools.checkstyle.checks.whitespace.WhitespaceAfterCheck"
                },
                {
                    "line": "127",
                    "column": "22",
                    "severity": "error",
                    "message": "'return' is not preceded with whitespace.",
                    "source": "com.puppycrawl.tools.checkstyle.checks.whitespace.WhitespaceAroundCheck"
                }
            ],
            "diff": "diff --git a/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/errored/1/426/SampleQcLocalAnalysisExecutor.java b/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/styler_three_grams/426/SampleQcLocalAnalysisExecutor.java\nindex 1d1cfd99ce7..93e29819f70 100644\n--- a/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/errored/1/426/SampleQcLocalAnalysisExecutor.java\n+++ b/home/fernanda/mnt/fernanda/git-styler/styler/python/experiments/results/opencb-opencga/styler_three_grams/426/SampleQcLocalAnalysisExecutor.java\n@@ -123,8 +123,8 @@ public class SampleQcLocalAnalysisExecutor extends SampleQcAnalysisExecutor impl\n \n         // Check BAM file\n         if (catalogBamFile == null) {\n-            addWarning(\"Skipping picard/CollectHsMetrics analysis: no BAM file was provided and no BAM file found for sample \" + sample.getId());\n-            return;\n+            addWarning(\"Skipping picard/CollectHsMetrics analysis: no BAM file was provided and no BAM file found for sample \"+sample.\n+            getId());return;\n         }\n \n         // Check bait file\n",
            "diff_size": 2
        }
    ],
    "repaired_by": [
        "intellij"
    ],
    "not_repaired_by": [
        "styler",
        "naturalize",
        "codebuff",
        "styler_random",
        "styler_three_grams"
    ]
}